import{_ as D}from"./index-1P3Q4JPB.js";import{B as S}from"./Sidebar-CVjNu7-1.js";import{D as $,o as n,f as l,h as I,l as d,g as t,s as N,F as b,x as E,n as g,k as _,t as o,a as C,r as c}from"./vendor-DYpG4QdT.js";const R={class:"bg-[#FAF9F5] text-gray-800 antialiased min-h-screen flex relative"},M={class:"flex-1 overflow-y-auto bg-[#FAF9F5] p-4 lg:p-8 transition-all duration-300"},V={class:"max-w-6xl mx-auto"},T={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 animate-fadeIn"},P={class:"flex items-center gap-3"},U={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 animate-fadeIn",style:{"animation-delay":"0.1s"}},z={class:"flex border-b border-gray-200 mb-6 font-bold text-sm"},J={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-[#E54801]"},O={key:0,class:"ml-2 bg-[#E54801] text-white text-[10px] px-1.5 py-0.5 rounded-full"},q={key:1,class:"absolute bottom-0 left-0 w-full h-0.5 bg-[#E54801]"},G={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden animate-fadeIn",style:{"animation-delay":"0.2s"}},H={class:"overflow-x-auto"},K={class:"w-full text-left"},Q={class:"bg-gray-50/50 border-b border-gray-50"},W={class:"px-6 py-4 text-[10px] font-bold text-gray-400 uppercase tracking-widest"},X={class:"px-6 py-4 text-[10px] font-bold text-gray-400 uppercase tracking-widest text-center"},Y={class:"divide-y divide-gray-50"},Z={key:0},tt={key:0},et={class:"px-6 py-4"},st={class:"flex items-center gap-3"},at={class:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-xs shadow-sm bg-blue-100 text-blue-600"},nt={class:"text-sm font-bold text-gray-900 group-hover:text-[#E54801] transition-colors"},lt={class:"text-[11px] text-gray-500 font-medium"},ot={class:"px-6 py-4"},it={class:"text-sm font-medium text-gray-700"},rt={class:"px-6 py-4 text-center"},dt={class:"px-6 py-4"},ct={class:"text-sm font-bold text-gray-900"},ut={class:"px-6 py-4 text-right"},xt={class:"flex justify-end gap-2 opacity-80 group-hover:opacity-100 transition-opacity"},pt={key:0,class:"w-auto h-8 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-all flex items-center justify-center gap-2 px-3 animate-pulse"},gt={key:0},ft={class:"px-6 py-4"},vt={class:"flex items-center gap-3"},yt={class:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-xs shadow-sm bg-orange-100 text-orange-600"},mt={class:"text-sm font-bold text-gray-900 group-hover:text-[#E54801] transition-colors"},bt={class:"text-[11px] text-gray-500 font-medium"},ht={class:"px-6 py-4"},_t={class:"text-sm font-medium text-gray-700"},wt={class:"px-6 py-4"},kt={class:"text-sm font-bold text-gray-900"},Et={class:"px-6 py-4 text-right"},Ct={class:"flex justify-end gap-2 opacity-80 group-hover:opacity-100 transition-opacity"},jt=["onClick"],At=["onClick"],Ft={__name:"MesLocataires",setup(Lt){const w=c(!0),f=c(!1),i=c("active"),k=c(!0),u=c([{label:"Actifs",value:0,highlight:!1},{label:"En attente",value:0,highlight:!0},{label:"Impays",value:0,highlight:!1},{label:"Total Biens",value:0,highlight:!1}]),h=c([]),x=c([]),j=async()=>{k.value=!0;try{const[r,e]=await Promise.all([C.get("/api/bailleur/properties"),C.get("/api/bailleur/applications")]);if(r.data.success){const s=r.data.data.data;h.value=s.filter(a=>a.rental_status==="occupied").map(a=>{var y,m,p,L;return{id:a.id,name:((y=a.tenant)==null?void 0:y.name)||"Locataire inconnu",initials:(m=a.tenant)!=null&&m.name?a.tenant.name.split(" ").map(B=>B[0]).join("").toUpperCase().slice(0,2):"??",joinDate:(L=(p=a.rentals)==null?void 0:p[0])!=null&&L.start_date?`S'est install le ${new Date(a.rentals[0].start_date).toLocaleDateString()}`:"Install",property:a.title,rent:a.monthly_rent,status:a.payment_status==="unpaid"?"Retard":"À Jour",statusClass:a.payment_status==="unpaid"?"bg-red-50 text-red-600 animate-pulse":"bg-green-50 text-green-600",hasAlert:a.payment_status==="unpaid",avatarBg:"bg-blue-100",avatarColor:"text-blue-600"}});const v=s.filter(a=>a.payment_status==="unpaid").length;u.value[0].value=h.value.length,u.value[2].value=v,u.value[2].highlight=v>0,u.value[3].value=r.data.data.total}e.data.success&&(x.value=e.data.data,u.value[1].value=x.value.length)}catch(r){console.error("Erreur chargement locataires:",r)}finally{k.value=!1}},A=async(r,e)=>{try{const{data:s}=await C.post(`/api/bailleur/applications/${r}/status`,{status:e});s.success&&(alert(e==="active"?"Candidature accepte !":"Candidature refuse."),await j())}catch(s){console.error("Erreur status candidature:",s),alert("Une erreur est survenue.")}};$(j);const F=r=>new Intl.NumberFormat("fr-FR").format(r||0);return(r,e)=>(n(),l("div",R,[I(S,{expanded:w.value,"is-open":f.value,onToggleExpand:e[0]||(e[0]=s=>w.value=!w.value)},null,8,["expanded","is-open"]),f.value?(n(),l("div",{key:0,onClick:e[1]||(e[1]=s=>f.value=!1),class:"fixed inset-0 bg-black/50 z-30 backdrop-blur-sm lg:hidden transition-opacity duration-300"})):d("",!0),t("main",M,[t("div",V,[t("div",T,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 leading-tight"}," Mes Locataires "),t("p",{class:"text-gray-500 text-sm mt-1 font-medium tracking-wide"}," Suivi des baux, paiements et communication avec vos résidents. ")],-1)),t("div",P,[t("button",{onClick:e[2]||(e[2]=s=>f.value=!f.value),class:"lg:hidden p-2 text-gray-500 hover:text-[#E54801] transition-colors"},[...e[5]||(e[5]=[t("i",{class:"fas fa-bars text-xl"},null,-1)])]),e[6]||(e[6]=N('<div class="flex gap-2" data-v-2d7f7f2d><button class="px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-xl text-xs font-bold hover:bg-gray-50 transition-all uppercase tracking-wider flex items-center gap-2" data-v-2d7f7f2d><i class="fas fa-file-export" data-v-2d7f7f2d></i><span class="hidden sm:inline" data-v-2d7f7f2d>Exporter</span></button><button class="px-5 py-2.5 bg-[#1B0B38] text-white rounded-xl text-xs font-bold hover:scale-105 transition-all shadow-md uppercase tracking-wider flex items-center gap-2" data-v-2d7f7f2d><i class="fas fa-plus font-bold" data-v-2d7f7f2d></i><span class="hidden sm:inline" data-v-2d7f7f2d>Nouveau Bail</span></button></div>',1))])]),t("div",U,[(n(!0),l(b,null,E(u.value,s=>(n(),l("div",{key:s.label,class:g(["bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center justify-center text-center transition-transform hover:-translate-y-1 hover:shadow-md",{"border-b-4 border-b-[#E54801]":s.highlight}])},[t("p",{class:g(["text-[10px] font-bold uppercase mb-1 tracking-widest leading-none",s.highlight?"text-[#E54801]":"text-gray-400"])},o(s.label),3),t("p",{class:g(["text-2xl font-bold leading-none",s.highlight?"text-[#E54801]":"text-gray-900"])},o(s.value),3)],2))),128))]),t("div",z,[t("button",{onClick:e[3]||(e[3]=s=>i.value="active"),class:g(["px-6 py-3 transition-all relative",i.value==="active"?"text-[#E54801]":"text-gray-400 hover:text-gray-600"])},[e[8]||(e[8]=_(" Locataires Actifs ",-1)),i.value==="active"?(n(),l("div",J)):d("",!0)],2),t("button",{onClick:e[4]||(e[4]=s=>i.value="pending"),class:g(["px-6 py-3 transition-all relative",i.value==="pending"?"text-[#E54801]":"text-gray-400 hover:text-gray-600"])},[e[9]||(e[9]=_(" Candidatures ",-1)),x.value.length?(n(),l("span",O,o(x.value.length),1)):d("",!0),i.value==="pending"?(n(),l("div",q)):d("",!0)],2)]),t("div",G,[t("div",H,[t("table",K,[t("thead",Q,[t("tr",null,[t("th",W,o(i.value==="active"?"Locataire":"Candidat"),1),e[10]||(e[10]=t("th",{class:"px-6 py-4 text-[10px] font-bold text-gray-400 uppercase tracking-widest"}," Bien ",-1)),t("th",X,o(i.value==="active"?"Status Logement":"Dossier"),1),e[11]||(e[11]=t("th",{class:"px-6 py-4 text-[10px] font-bold text-gray-400 uppercase tracking-widest"}," Loyer ",-1)),e[12]||(e[12]=t("th",{class:"px-6 py-4 text-[10px] font-bold text-gray-400 uppercase tracking-widest text-right"}," Actions ",-1))])]),t("tbody",Y,[k.value?(n(),l("tr",Z,[...e[13]||(e[13]=[t("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-400"},[t("i",{class:"fas fa-circle-notch fa-spin text-2xl mb-2 text-[#E54801]"}),t("p",{class:"text-xs font-medium"},"Chargement des donnés...")],-1)])])):i.value==="active"?(n(),l(b,{key:1},[h.value.length===0?(n(),l("tr",tt,[...e[14]||(e[14]=[t("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-400"},[t("p",{class:"text-sm font-medium"},"Aucun locataire actif.")],-1)])])):d("",!0),(n(!0),l(b,null,E(h.value,s=>(n(),l("tr",{key:s.id,class:"hover:bg-gray-50/80 transition-colors group"},[t("td",et,[t("div",st,[t("div",at,o(s.initials),1),t("div",null,[t("p",nt,o(s.name),1),t("p",lt,o(s.joinDate),1)])])]),t("td",ot,[t("p",it,o(s.property),1)]),t("td",rt,[t("span",{class:g(["px-2.5 py-1 text-[10px] font-bold rounded-lg uppercase tracking-wide inline-block min-w-[80px]",s.statusClass])},o(s.status),3)]),t("td",dt,[t("p",ct,[_(o(F(s.rent))+" ",1),e[15]||(e[15]=t("span",{class:"text-[10px] font-normal text-gray-400 italic"},"CFA",-1))])]),t("td",ut,[t("div",xt,[e[17]||(e[17]=t("button",{class:"w-8 h-8 rounded-lg bg-gray-50 text-gray-500 hover:text-[#E54801] hover:bg-[#E54801]/10 transition-all flex items-center justify-center"},[t("i",{class:"fas fa-eye text-xs"})],-1)),e[18]||(e[18]=t("button",{class:"w-8 h-8 rounded-lg bg-gray-50 text-gray-500 hover:text-[#E54801] hover:bg-[#E54801]/10 transition-all flex items-center justify-center"},[t("i",{class:"fas fa-comment text-xs"})],-1)),s.hasAlert?(n(),l("button",pt,[...e[16]||(e[16]=[t("i",{class:"fas fa-bell text-xs"},null,-1),t("span",{class:"text-[10px] font-bold uppercase hidden sm:inline"},"Relance",-1)])])):d("",!0)])])]))),128))],64)):i.value==="pending"?(n(),l(b,{key:2},[x.value.length===0?(n(),l("tr",gt,[...e[19]||(e[19]=[t("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-400"},[t("p",{class:"text-sm font-medium"}," Aucune candidature en attente. ")],-1)])])):d("",!0),(n(!0),l(b,null,E(x.value,s=>{var v,a,y,m;return n(),l("tr",{key:s.id,class:"hover:bg-gray-50/80 transition-colors group"},[t("td",ft,[t("div",vt,[t("div",yt,o((v=s.tenant)!=null&&v.name?s.tenant.name.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,2):"??"),1),t("div",null,[t("p",mt,o((a=s.tenant)==null?void 0:a.name),1),t("p",bt," Demande le "+o(new Date(s.created_at).toLocaleDateString()),1)])])]),t("td",ht,[t("p",_t,o((y=s.property)==null?void 0:y.title),1)]),e[23]||(e[23]=t("td",{class:"px-6 py-4 text-center"},[t("span",{class:"px-2.5 py-1 text-[10px] font-bold rounded-lg uppercase tracking-wide inline-block bg-orange-50 text-orange-600"}," En attente ")],-1)),t("td",wt,[t("p",kt,[_(o(F(s.monthly_rent||((m=s.property)==null?void 0:m.price)))+" ",1),e[20]||(e[20]=t("span",{class:"text-[10px] font-normal text-gray-400 italic"},"CFA",-1))])]),t("td",Et,[t("div",Ct,[t("button",{onClick:p=>A(s.id,"active"),class:"h-8 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 transition-all flex items-center justify-center gap-2 px-3"},[...e[21]||(e[21]=[t("i",{class:"fas fa-check text-xs"},null,-1),t("span",{class:"text-[10px] font-bold uppercase"},"Accepter",-1)])],8,jt),t("button",{onClick:p=>A(s.id,"rejected"),class:"h-8 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-all flex items-center justify-center gap-2 px-3"},[...e[22]||(e[22]=[t("i",{class:"fas fa-times text-xs"},null,-1),t("span",{class:"text-[10px] font-bold uppercase"},"Refuser",-1)])],8,At)])])])}),128))],64)):d("",!0)])])])])])])]))}},$t=D(Ft,[["__scopeId","data-v-2d7f7f2d"]]);export{$t as default};
